/// 
clear
cd  "E:\Signinid Dropbox\Mobina Shojaee\Shojaei's Thesis Project\Data\Do\22"
use "E:\Signinid Dropbox\Mobina Shojaee\Shojaei's Thesis Project\Data\Do\20_reg&synthetic control\import_m_90.dta"


/// The total value in rials and dollars, as well as the weight, is calculated for each tariff code and month, with no duplicate tariff codes within the same month.

collapse (sum) rialvalue dolarvalue weight, by( month_year year month tariff )

/// Complete panel structure
/// Generate all possible combinations of tariff, year, and month
/// If data for a tariff code is missing in a given month, we replace it with 0.
fillin tariff year month 

/// month_yris like 139504
gen month_yr = year * 100 + month
drop month_year


drop _fillin
/// exchange rate group 
/// Merge the data with the exchange rate group information to identify which goods fall under the preferential, NIMA, or personal import groups.
merge m:m tariff month_yr using  "E:\Dropbox\Shojaei's Thesis Project\Data\Eligible Products\Maps\HS_dta\HS_1390_1402.dta", keep(match master) nogen

gen month_year=ym(year,month)
format month_year %tm

/// In the `data.dta` file, I have saved the monthly exchange rate premium for preferential and Nima data, along with the monthly CPI data for Iran and the US, to calculate the real value.

merge m:1 month_year using "E:\Signinid Dropbox\Mobina Shojaee\Shojaei's Thesis Project\Data\Do\20_reg&synthetic control\data_EX.dta", keep(match master) nogen

/// The base year for Iran's CPI is 1400. I have adjusted the base year for the CPI_US to 2021, equivalent to 1400 in the Iranian calendar.
gen cpi_us_s = (cpi_us/276.21)*100
replace dolarvalue = 0 if dolarvalue == .
/// To calculate the real dollar value, divide the nominal dollar value by the CPI_US
gen realvalue= (dolarvalue/cpi_us_s) *100
/// I changed its unit to millions of dollars.
gen realvalue_million= realvalue/1000000

tostring tariff, replace force format(%08.0f)

drop if year==.

gen nima_t = (exchangeratenima + sana_exchange) / 2
gen premium_nima_t = ( exchangerate_m - nima_t)/ exchangerate_m
/// gen premium for which group NIMA
. gen premium = 0

replace premium = premium_ex if group == 1

replace premium = premium_nima if (group == 2 | group == 21 | group == 22 | group == 23 ) & month_yr >= 139702 & month_yr < 139907
replace premium = premium_nima if (group == 21 | group == 2) & month_yr >= 139907
replace premium = premium_nima_t if (group == 24 | group == 25 | group == 26) & month_yr >= 139702 & month_yr < 139907
replace premium = premium_nima_t if (group == 22 | group == 23 | group == 24 | group == 25 | group == 26) &  month_yr >= 139907


/// Goods that were receiving the 4200 Toman exchange rate after its removal
replace premium = ((exchangerate_m - 42000) / exchangerate_m) * 100 ///
if (tariff=="30012000" | tariff=="30019000" | tariff=="30021100" | tariff=="30021210" | ///
tariff=="30021220" | tariff=="30021290" | tariff=="30021311" | tariff=="30021312" | /// 
tariff=="30021321" | tariff=="30021322" | tariff=="30021411" | tariff=="30021412" | ///
tariff=="30021421" | tariff=="30021422" | tariff=="30021511" | tariff=="30021512" | ///
tariff=="30021521" | tariff=="30021522" | tariff=="30021900" | tariff=="30022000" | ///
tariff=="30023010" | tariff=="30023090" | tariff=="30029010" | tariff=="30031010" | ///
tariff=="30031090" | tariff=="30032010" | tariff=="30032090" | tariff=="30033110" | ///
tariff=="30033190" | tariff=="30033910" | tariff=="30033990" | tariff=="30034110" | ///
tariff=="30034190" | tariff=="30034210" | tariff=="30034290" | tariff=="30034310" | ///
tariff=="30034390" | tariff=="30034910" | tariff=="30034990" | tariff=="30036000" | ///
tariff=="30039010" | tariff=="30039090" | tariff=="30041011" | tariff=="30041012" | ///
tariff=="30041021" | tariff=="30041022" | tariff=="30042011" | tariff=="30042012" | ///
tariff=="30042021" | tariff=="30042022" | tariff=="30043110" | tariff=="30043190" | ///
tariff=="30043211" | tariff=="30043212" | tariff=="30043221" | tariff=="30043222" | ///
tariff=="30043911" | tariff=="30043912" | tariff=="30043921" | tariff=="30043922" | ///
tariff=="30044110" | tariff=="30044190" | tariff=="30044210" | tariff=="30044290" | ///
tariff=="30044310" | tariff=="30044390" | tariff=="30044910" | tariff=="30044990" | ///
tariff=="30045011" | tariff=="30045012" | tariff=="30045021" | tariff=="30045022" | ///
tariff=="30046000" | tariff=="30049011" | tariff=="30049012" | tariff=="30049013" | ///
tariff=="30049014" | tariff=="30049015" | tariff=="30049016" | tariff=="30049091" | ///
tariff=="30049092" | tariff=="30051010" | tariff=="30051020" | tariff=="30051030" | ///
tariff=="30051090" | tariff=="30059020" | tariff=="30059090" | tariff=="30061010" | ///
tariff=="30061090" | tariff=="30062000" | tariff=="30063010" | tariff=="30063090" | ///
tariff=="30064010" | tariff=="30064020" | tariff=="30064030" | tariff=="30064040" | ///
tariff=="30064050" | tariff=="30064060" | tariff=="30064090" | tariff=="30065000" | ///
tariff=="30066000" | tariff=="30067010" | tariff=="30067090" | tariff=="30069100" | ///
tariff=="30069200") ///
& month_yr >= 140111 
/// wheat 
/// don't receive tajihi currency
replace premium = premium_nima if  ( tariff=="10011100" | tariff=="10019100") & month_yr >= 140103 & month_yr < 140111

///  Medical Equipment & Infant Formula
replace premium = ((exchangerate_m - 42000) / exchangerate_m) * 100 ///
if (tariff=="04021010" | tariff=="04022110"| tariff=="90181110" | tariff=="90181120" | tariff=="90181130" | ///
tariff=="90181190" | tariff=="90181210" | tariff=="90181220" | tariff=="90181230" | ///
tariff=="90181240" | tariff=="90181280" | tariff=="90181290" | tariff=="90181310" | ///
tariff=="90181390" | tariff=="90181410" | tariff=="90181490" | tariff=="90181911" | ///
tariff=="90181919" | tariff=="90181920" | tariff=="90181921" | tariff=="90181922" | ///
tariff=="90181923" | tariff=="90181924" | tariff=="90181925" | tariff=="90181926" | ///
tariff=="90181950" | tariff=="90181955" | tariff=="90181960" | tariff=="90181961" | ///
tariff=="90181990" | tariff=="90181991" | tariff=="90183110" | tariff=="90183190" | ///
tariff=="90183210" | tariff=="90183220" | tariff=="90183230" | tariff=="90183235" | ///
tariff=="90183240" | tariff=="90183250" | tariff=="90183260" | tariff=="90183270" | ///
tariff=="90183285" | tariff=="90183910" | tariff=="90183911" | tariff=="90183912" | ///
tariff=="90183913" | tariff=="90183914" | tariff=="90183915" | tariff=="90183916" | ///
tariff=="90183917" | tariff=="90183918" | tariff=="90183919" | tariff=="90183920" | ///
tariff=="90183921" | tariff=="90183922" | tariff=="90183923" | tariff=="90183925" | ///
tariff=="90183926" | tariff=="90183927" | tariff=="90183928" | tariff=="90183929" | ///
tariff=="90183990" | tariff=="90184911" | tariff=="90184919" | tariff=="90184921" | ///
tariff=="90184929" | tariff=="90184930" | tariff=="90184946" | tariff=="90184947" | ///
tariff=="90184991" | tariff=="90184992" | tariff=="90185010" | tariff=="90185030" | ///
tariff=="90185040" | tariff=="90185080" | tariff=="90185090" | tariff=="90189011" | ///
tariff=="90189019" | tariff=="90189021" | tariff=="90189029" | tariff=="90189030" | ///
tariff=="90189031" | tariff=="90189051" | tariff=="90189059" | tariff=="90189069" | ///
tariff=="90189070" | tariff=="90189076" | tariff=="90189077" | tariff=="90189080" | ///
tariff=="90189081" | tariff=="90189082" | tariff=="90189084" | tariff=="90189085" | ///
tariff=="90189086" | tariff=="90189087" | tariff=="90189088" | tariff=="90189091" | ///
tariff=="90191010" | tariff=="90191030" | tariff=="90191040" | tariff=="90191090" | ///
tariff=="90192010" | tariff=="90192020" | tariff=="90192030" | tariff=="90192090" | ///
tariff=="90200000" | tariff=="90211010" | tariff=="90211090" | tariff=="90213100" | ///
tariff=="90213990" | tariff=="90214010" | tariff=="90214020" | tariff=="90214030" | ///
tariff=="90214090" | tariff=="90215000" | tariff=="90219010" | tariff=="90219020" | ///
tariff=="90219030" | tariff=="90219040" | tariff=="90219050" | tariff=="90219090" | ///
tariff=="90221200" | tariff=="90221310" | tariff=="90221320" | tariff=="90221390" | ///
tariff=="90221410" | tariff=="90221420" | tariff=="90221430" | tariff=="90221440" | ///
tariff=="90221490" | tariff=="90222100" | tariff=="90223000" | tariff=="90229000" | ///
tariff=="90251110" | tariff=="90251910" | tariff=="90268010" | tariff=="90272000" | ///
tariff=="90273010" | tariff=="90273020" | tariff=="90273090" | tariff=="90275010" | ///
tariff=="90275030" | tariff=="90275090" | tariff=="90278010" | tariff=="90278020" | ///
tariff=="90278030" | tariff=="90278040" | tariff=="90278050" | tariff=="90278060" | ///
tariff=="90278090" | tariff=="90279010" | tariff=="90279020" | tariff=="90279030" | ///
tariff=="90279090") ///
& month_yr >= 140105 

/// Intermediate industrial goods receive the 37,500 Toman exchange rate

replace premium = ((exchangerate_m - 375000) / exchangerate_m) * 100 ///
if (substr(tariff,1,2)=="25" | substr(tariff,1,2)=="26" | substr(tariff,1,2)=="27" | ///
    substr(tariff,1,2)=="28" | substr(tariff,1,2)=="29" | substr(tariff,1,2)=="33" | substr(tariff,1,2)=="35" | ///
    substr(tariff,1,3)=="392" | substr(tariff,1,2)=="47" | substr(tariff,1,2)=="84" | substr(tariff,1,2)=="85" | ///
    substr(tariff,1,2)=="72" | substr(tariff,1,2)=="73" | substr(tariff,1,2)=="74" | substr(tariff,1,2)=="75" | ///
    substr(tariff,1,2)=="76" | substr(tariff,1,2)=="80" | substr(tariff,1,2)=="988") ///
    & month_yr >= 140201 ///
	& (group != 1 | group != 23 | group != 24 | group != 25 | group != 26 | group != 3 | group != 27)

replace group = 3 if group == .
replace premium=0 if premium==.
replace realvalue = 0 if realvalue == .
/// gap var is arcsin hyperbolic premium var
gen gap = asinh(premium)

/// arcsin hyperbolic dolar realvalue
gen realvalue_im = asinh(realvalue) 


/// BEC 

/// at first convert HS code to BEC capital & consumption & Intermediate goods based on HS6

gen bec = 0

local tariffs "010129 010130 010190 010229 010239 010290 010391 010392 010410 010420 010511 010512 010513 010514 010515 010594 010599 010611 010612 010613 010614 010619 010620 010631 010632 010633 010639 010641 010649 010690 080111 080112 080119 081210 081290 081400 090111 090112 100111 100119 100191 100199 100210 100290 100310 100390 100610 100620 100710 100790 100810 100821 100829 100830 100840 100850 100860 100890 120110 120190 120230 120241 120242 120300 120510 120590 120600 120710 120721 120729 120730 120740 120750 120760 120770 120791 120799 121010 121020 121291 121292 121293 121294 121299 180100 350211 350219100110 100190 100300 120100 120210 120220 120720 100110 100820 801110 801120 350219"

foreach tariff of local tariffs {
    replace bec = 111 if substr(tariff, 1, 6) == "`tariff'"
}
 
local tariffs "030191 030192 030193 030194 030195 030199 030211 030213 030214 030219 030221 030222 030223 030224 030229 030231 030232 030233 030234 030235 030236 030239 030241 030242 030243 030244 030245 030246 030247 030249 030251 030252 030253 030254 030255 030256 030259 030264 030271 030272 030273 030274 030279 030281 030282 030283 030284 030285 030289 030292 030299 030551 030552 030553 030554 030559 030561 030562 030563 030564 030569 030571 030572 030579 030611 030612 030614 030615 030616 030617 030619 030631 030632 030633 030635 030636 030691 030692 030693 030695 030711 030712 030719 030721 030722 030729 030731 030732 030739 030742 030743 030749 030751 030752 030759 030771 030772 030779 030781 030782 030783 030784 030787 030788 030791 030792 030799 030811 030812 030819 030821 030822 030829 030830 030890 040110 040120 040140 040150 040310 040390 040711 040719 040721 040729 040790 040900 070190 070200 070310 070320 070390 070410 070420 070490 070511 070519 070521 070529 070610 070690 070700 070810 070820 070890 070920 070930 070940 070951 070959 070960 070970 070991 070992 070993 070999 071010 071021 071022 071029 071030 071040 071080 071090 071310 071320 071331 071332 071333 071334 071335 071339 071340 071350 071360 071390 071410 071420 071430 071440 071450 071490 080121 080122 080131 080132 080211 080212 080221 080222 080231 080232 080241 080242 080251 080252 080261 080262 080270 080280 080290 080310 080390 080410 080420 080430 080440 080450 080510 080521 080522 080529 080540 080550 080590 080610 080620 080711 080719 080720 080810 080830 080840 080910 080921 080929 080930 080940 081010 081020 081030 081040 081050 081060 081070 081090 081110 081120 081190 081310 081320 081330 081340 081350 090210 090220 090230 090240 090300 090411 090412 090421 090422 090510 090520 090611 090619 090620 090710 090720 090811 090812 090821 090822 090831 090832 090921 090922 090931 090932 090961 090962 091011 091012 091020 091030 091091 091099 040700 080300 080820 090420 090500 090700 090810 090820 090830 090910 090920 090930 091010 080120 080520 301912 304610 407111 710400 803100 804300 902401 908119 909619" 

foreach tariff of local tariffs {
    replace bec = 112 if substr(tariff, 1, 6) == "`tariff'"
}
 
local tariffs "020110 020210 020311 020321 020410 020421 020430 020441 020500 020910 020990 030510 040210 040410 040490 040811 040819 040891 040899 110100 110220 110290 110311 110313 110319 110320 110510 110520 110610 110620 110630 110710 110720 110900 120810 120890 150420 150430 150710 150810 151000 151110 151190 151211 151221 151229 151311 151319 151321 151329 151411 151491 151521 151550 151610 151620 160300 170112 170113 170114 170191 170211 170219 170230 170240 170250 170260 170290 170310 170390 180310 180320 180400 180500 180620 190190 190300 210210 210220 210230 220430 230210 230230 230240 230250 230700 350710 110210 170111"


foreach tariff of local tariffs {
    replace bec = 121 if substr(tariff, 1, 6) == "`tariff'"
}

local tariffs"020120 020130 020220 020230 020312 020319 020322 020329 020422 020423 020442 020443 020450 020610 020621 020622 020629 020630 020641 020649 020680 020690 020711 020712 020713 020714 020724 020725 020726 020727 020741 020742 020743 020744 020745 020751 020752 020753 020754 020755 020760 020810 020830 020840 020850 020860 020890 021011 021012 021019 021020 021091 021092 021093 021099 030291 030311 030312 030313 030314 030319 030322 030323 030324 030325 030326 030329 030331 030332 030333 030334 030339 030341 030342 030343 030344 030345 030346 030349 030351 030353 030354 030355 030356 030357 030359 030363 030364 030365 030366 030367 030368 030369 030381 030382 030383 030384 030389 030391 030392 030399 030431 030432 030433 030439 030441 030442 030443 030444 030445 030446 030447 030448 030449 030451 030452 030453 030454 030455 030456 030457 030459 030461 030462 030463 030469 030471 030472 030473 030474 030475 030479 030481 030482 030483 030484 030485 030486 030487 030488 030489 030491 030492 030493 030494 030495 030496 030497 030499 030520 030531 030532 030539 030541 030542 030543 030544 030549 030571 030572 030579 030611 030612 030614 030615 030616 030617 030619 030631 030632 030633 030634 030635 030636 030639 030691 030692 030693 030694 030695 030699 030712 030719 030722 030729 030732 030739 030743 030749 030752 030759 030760 030772 030779 030783 030784 030787 030788 030792 030799 030812 030819 030822 030829 030830 030890 040221 040229 040291 040299 040510 040520 040590 040610 040620 040630 040640 040690 041000 071120 071140 071151 071159 071190 071220 071231 071232 071233 071239 071290 090121 090122 090190 100630 100640 110412 110419 110422 110423 110429 110430 121120 121190 150790 150890 150910 150990 151219 151419 151499 151529 151710 151790 160100 160210 160220 160231 160232 160239 160241 160242 160249 160250 160290 160411 160412 160413 160414 160415 160416 160417 160418 160419 160420 160431 160432 160510 160521 160529 160530 160540 160551 160552 160553 160554 160555 160556 160557 160558 160559 160561 160562 160563 160569 170199 170220 170410 170490 180610 180631 180632 180690 190110 190120 190211 190219 190220 190230 190240 190410 190420 190430 190490 190510 190520 190531 190532 190540 190590 200110 200190 200210 200290 200310 200390 200410 200490 200510 200520 200540 200551 200559 200560 200570 200580 200591 200599 200600 200710 200791 200799 200811 200819 200820 200830 200840 200850 200860 200870 200880 200891 200893 200897 200899 200911 200912 200919 200921 200929 200931 200939 200941 200949 200950 200961 200969 200971 200979 200981 200989 200990 210111 210112 210120 210130 210310 210320 210330 210390 210410 210420 210500 210610 210690 220110 220190 220210 220291 220299 220300 220410 220421 220422 220429 220510 220590 220600 220820 220830 220840 220850 220860 220870 220890 220900 030352 030372 030374 030375 030378 030379 030419 030429 030629 030710 030741 200892 200980 220290 030626 040720 150920 150930 150940 202309 020243 303420 405102 303430"


foreach tariff of local tariffs {
    replace bec = 122 if substr(tariff, 1, 6) == "`tariff'"
}

local tariffs"050100 050210 050290 050400 050510 050590 050610 050690 050710 050790 050800 051000 051110 051191 051199 060110 060120 060210 060220 060230 060240 060290 060420 060490 070110 100410 100490 100510 100590 120400 120710 120730 120760 120770 120799 120910 120921 120922 120923 120924 120925 120929 120930 120991 120999 121120 121130 121140 121150 121190 121221 121229 121300 121410 121490 130120 130190 130211 130212 130213 130214 130219 130220 140110 140120 140190 140420 140490 152200 180200 230310 230320 230330 230800 240110 240120 240130 250100 250200 250300 250410 250490 250510 250590 250610 250620 250700 250810 250830 250840 250850 250860 250870 250900 251010 251020 251110 251120 251200 251310 251320 251400 251511 251512 251520 251611 251612 251620 251690 251710 251720 251730 251741 251749 251810 251820 251830 251910 251990 252010 252100 252410 252490 252510 252520 252530 252610 252620 252800 252910 252921 252922 252930 253010 253020 253090 260111 260112 260120 260200 260300 260400 260500 260600 260700 260800 260900 261000 261100 261210 261220 261310 261390 261400 261510 261590 261610 261690 261710 261790 261800 261900 262011 262019 262021 262029 262030 262040 262060 262091 262099 262110 262190 271091 271099 271410 271490 284450 300692 310100 310250 310490 382510 382520 382530 382541 382549 382550 382561 382569 382590 391510 391520 391530 391590 400110 400121 400122 400129 400130 400300 400400 410120 410150 410190 410210 410221 410229 410320 410330 410390 411520 430110 430130 430160 430180 430190 440121 440122 440131 440139 440140 440311 440312 440321 440322 440323 440324 440325 440326 440341 440349 440391 440393 440394 440395 440396 440397 440398 440399 440410 440420 450110 450190 450200 470710 470720 470730 470790 500100 500300 510111 510119 510121 510129 510130 510211 510219 510220 510310 510320 510330 510400 520100 520210 520291 520299 530110 530130 530210 530290 530310 530390 530500 550510 550520 630900 631010 631090 700100 710110 710121 710210 710221 710231 710310 710510 710590 711230 711291 711292 711299 720410 720421 720429 720430 720441 720449 720450 740400 750300 760200 780200 790200 800200 810197 810297 810330 810420 810530 810730 810830 810930 811020 811213 811222 811252 854231 854232 854233 854239 854810 890800 060499 100400 121220 252890 380223 440130 440310 440320 440392 440220 440342 601109 602909 690293 854911 854921"


foreach tariff of local tariffs {
    replace bec = 21 if substr(tariff, 1, 6) == "`tariff'"
}

local tariffs"110811 110812 110813 110814 110819 110820 130231 130232 130239 150110 150120 150190 150210 150290 150300 150410 150500 150600 151511 151519 151530 151590 151800 152000 152110 152190 220710 220720 230110 230120 230400 230500 230610 230620 230630 230641 230649 230650 230660 230690 230990 240399 252020 252210 252220 252230 252310 252321 252329 252330 252390 270600 270710 270720 270730 270740 270750 270791 270799 270810 270820 271210 271220 271290 271311 271312 271320 271390 271500 280110 280120 280130 280200 280300 280410 280421 280429 280430 280440 280450 280461 280469 280470 280480 280490 280511 280512 280519 280530 280540 280610 280620 280700 280800 280910 280920 281000 281111 281112 281119 281121 281122 281129 281211 281212 281213 281214 281215 281216 281217 281219 281290 281310 281390 281410 281420 281511 281512 281520 281530 281610 281640 281700 281810 281820 281830 281910 281990 282010 282090 282110 282120 282200 282300 282410 282490 282510 282520 282530 282540 282550 282560 282570 282580 282590 282612 282619 282630 282690 282710 282720 282731 282732 282735 282739 282741 282749 282751 282759 282760 282810 282890 282911 282919 282990 283010 283090 283110 283190 283210 283220 283230 283311 283319 283321 283322 283324 283325 283327 283329 283330 283340 283410 283421 283429 283510 283522 283524 283525 283526 283529 283531 283539 283620 283630 283640 283650 283660 283691 283692 283699 283711 283719 283720 283911 283919 283990 284011 284019 284020 284030 284130 284150 284161 284169 284170 284180 284190 284210 284290 284310 284321 284329 284330 284390 284410 284420 284430 284440 284510 284590 284610 284690 284700 284910 284920 284990 285000 285210 285290 285310 285390 290110 290121 290122 290123 290124 290129 290211 290219 290220 290230 290241 290242 290243 290244 290250 290260 290270 290290 290311 290312 290313 290314 290315 290319 290321 290322 290323 290329 290331 290339 290371 290372 290373 290374 290375 290376 290377 290378 290379 290381 290382 290383 290389 290391 290392 290393 290394 290399 290410 290420 290431 290432 290433 290434 290435 290436 290491 290499 290511 290512 290513 290514 290516 290517 290519 290522 290529 290531 290532 290539 290541 290542 290543 290544 290545 290549 290551 290559 290611 290612 290613 290619 290621 290629 290711 290712 290713 290715 290719 290721 290722 290723 290729 290811 290819 290891 290892 290899 290911 290919 290920 290930 290941 290943 290944 290949 290950 290960 291010 291020 291030 291040 291050 291090 291100 291211 291212 291219 291221 291229 291241 291242 291249 291250 291260 291300 291411 291412 291413 291419 291422 291423 291429 291431 291439 291440 291450 291461 291462 291469 291471 291479 291511 291512 291513 291521 291524 291529 291531 291532 291533 291536 291539 291540 291550 291560 291570 291590 291611 291612 291613 291614 291615 291616 291619 291620 291631 291632 291634 291639 291711 291712 291713 291714 291719 291720 291732 291733 291734 291735 291736 291737 291739 291811 291812 291813 291814 291815 291816 291817 291818 291819 291821 291822 291823 291829 291830 291891 291899 291910 291990 292011 292019 292021 292022 292023 292024 292029 292030 292090 292111 292112 292113 292114 292119 292121 292122 292129 292130 292141 292142 292143 292144 292145 292146 292149 292151 292159 292211 292212 292214 292215 292216 292217 292218 292219 292221 292229 292231 292239 292241 292242 292243 292244 292249 292250 292310 292320 292330 292340 292390 292411 292412 292419 292421 292423 292424 292425 292429 292511 292512 292519 292521 292529 292610 292620 292630 292640 292690 292700 292800 292910 292990 293020 293030 293040 293060 293070 293080 293090 293110 293120 293131 293132 293133 293134 293135 293136 293137 293138 293139 293190 293211 293212 293213 293214 293219 293220 293291 293292 293293 293294 293295 293299 293311 293319 293321 293329 293331 293332 293333 293339 293341 293349 293352 293353 293354 293355 293359 293361 293369 293371 293372 293379 293391 293392 293399 293410 293420 293430 293491 293499 293510 293520 293530 293540 293550 293590 293621 293622 293623 293624 293625 293626 293627 293628 293629 293690 293711 293712 293719 293721 293722 293723 293729 293750 293790 293810 293890 293911 293919 293920 293930 293941 293942 293943 293944 293949 293951 293959 293961 293962 293963 293969 293971 293979 293980 294000 294110 294120 294130 294140 294150 294190 294200 300120 300190 300211 300212 300213 300214 300215 300219 300220 300230 300290 300310 300320 300331 300339 300341 300342 300343 300349 300360 300390 300510 300590 300610 300620 300630 300640 300650 300670 310210 310221 310229 310230 310240 310260 310280 310290 310311 310319 310390 310420 310430 310490 310510 310520 310530 310540 310551 310559 310560 310590 320110 320120 320190 320210 320290 320300 320411 320412 320413 320414 320415 320416 320417 320419 320420 320490 320500 320611 320619 320620 320641 320642 320649 320650 320710 320720 320730 320740 320810 320820 320890 320910 320990 321000 321100 321210 321290 321410 321490 321511 321519 321590 330112 330113 330119 330124 330125 330129 330130 330190 330210 330290 340211 340212 340213 340219 340290 340420 340490 340700 350110 350190 350220 350290 350300 350400 350510 350520 350691 350699 350790 360100 360200 360300 360410 360490 360690 370110 370120 370130 370191 370199 370210 370231 370232 370239 370241 370242 370243 370244 370255 370256 370297 370298 370310 370320 370390 370400 370500 370610 370690 370710 370790 380110 380120 380130 380190 380210 380290 380300 380400 380510 380590 380610 380620 380630 380690 380700 380910 380991 380992 380993 381010 381090 381111 381119 381121 381129 381190 381210 381220 381231 381239 381300 381400 381511 381512 381519 381590 381600 381700 381800 381900 382000 382100 382200 382311 382312 382313 382319 382370 382410 382430 382440 382450 382460 382471 382472 382473 382474 382475 382476 382477 382478 382479 382481 382482 382483 382484 382485 382486 382487 382488 382491 382499 382600 390110 390120 390130 390140 390190 390210 390220 390230 390290 390311 390319 390320 390330 390390 390410 390421 390422 390430 390440 390450 390461 390469 390490 390512 390519 390521 390529 390530 390591 390599 390610 390690 390710 390720 390730 390740 390750 390761 390769 390770 390791 390799 390810 390890 390910 390920 390931 390939 390940 390950 391000 391110 391190 391211 391212 391220 391231 391239 391290 391310 391390 391400 391610 391620 391690 391710 391721 391722 391723 391729 391731 391732 391733 391739 391740 391810 391890 391910 391990 392010 392020 392030 392043 392049 392051 392059 392061 392062 392063 392069 392071 392073 392079 392091 392092 392093 392094 392099 392111 392112 392113 392114 392119 392190 392210 392290 392310 392321 392329 392330 392340 392350 392390 392510 392520 392590 392610 392630 400211 400219 400220 400231 400239 400241 400249 400251 400259 400260 400270 400280 400291 400299 400510 400520 400591 400599 400610 400690 400700 400811 400819 400821 400829 400911 400912 400921 400922 400931 400932 400941 400942 401490 401511 401693 401694 401699 401700 410411 410419 410441 410449 410510 410530 410621 410622 410631 410632 410640 410691 410692 410711 410712 410719 410791 410792 410799 411200 411310 411320 411330 411390 411410 411420 411510 420600 430211 430219 430220 430230 440500 440611 440612 440691 440692 440711 440712 440719 440721 440722 440725 440726 440727 440728 440729 440791 440792 440793 440794 440795 440796 440797 440799 440810 440831 440839 440890 440910 440921 440922 440929 441011 441012 441019 441090 441112 441113 441114 441192 441193 441194 441210 441231 441233 441234 441239 441294 441299 441300 441510 441520 441600 441700 441810 441820 441840 441850 441860 441873 441874 441875 441879 441891 441899 442191 442199 450310 450390 450410 450490 470100 470200 470311 470319 470321 470329 470411 470419 470421 470429 470500 470610 470620 470630 470691 470692 470693 480100 480210 480220 480240 480254 480255 480256 480257 480258 480261 480262 480269 480300 480411 480419 480421 480429 480431 480439 480441 480442 480449 480451 480452 480459 480511 480512 480519 480524 480525 480530 480540 480550 480591 480592 480593 480610 480620 480630 480640 480700 480810 480840 480890 480920 480990 481013 481014 481019 481022 481029 481031 481032 481039 481092 481099 481110 481141 481149 481151 481159 481160 481190 481200 481320 481390 481420 481490 481620 481690 481910 481920 481930 481940 481950 481960 482010 482030 482040 482090 482110 482190 482210 482290 482320 482340 482370 482390 490600 490700 490810 491110 491199 500200 500400 500500 500710 500720 500790 510510 510521 510529 510531 510539 510540 510610 510620 510710 510720 510810 510820 511000 511111 511119 511120 511130 511190 511211 511219 511220 511230 511290 511300 520300 520411 520419 520511 520512 520513 520514 520515 520521 520522 520523 520524 520526 520527 520528 520531 520532 520533 520534 520535 520541 520542 520543 520544 520546 520547 520548 520611 520612 520613 520614 520615 520621 520622 520623 520624 520625 520631 520632 520633 520634 520635 520641 520642 520643 520644 520645 520811 520812 520813 520819 520821 520822 520823 520829 520831 520832 520833 520839 520841 520842 520843 520849 520851 520852 520859 520911 520912 520919 520921 520922 520929 520931 520932 520939 520941 520942 520943 520949 520951 520952 520959 521011 521019 521021 521029 521031 521032 521039 521041 521049 521051 521059 521111 521112 521119 521120 521131 521132 521139 521141 521142 521143 521149 521151 521152 521159 521211 521212 521213 521214 521215 521221 521222 521223 521224 521225 530121 530129 530610 530620 530710 530720 530810 530820 530890 530911 530919 530921 530929 531010 531090 531100 540110 540120 540211 540219 540220 540231 540232 540233 540234 540239 540244 540245 540246 540247 540248 540249 540251 540252 540253 540259 540261 540262 540263 540269 540310 540331 540332 540333 540339 540341 540342 540349 540411 540412 540419 540490 540500 540710 540720 540730 540741 540742 540743 540744 540751 540752 540753 540754 540761 540769 540771 540772 540773 540774 540781 540782 540783 540784 540791 540792 540793 540794 540810 540821 540822 540823 540824 540831 540832 540833 540834 550110 550120 550130 550140 550190 550210 550290 550311 550319 550320 550330 550340 550390 550410 550490 550610 550620 550630 550640 550690 550700 550810 550820 550911 550912 550921 550922 550931 550932 550941 550942 550951 550952 550953 550959 550961 550962 550969 550991 550992 550999 551011 551012 551020 551030 551090 551211 551219 551221 551229 551291 551299 551311 551312 551313 551319 551321 551323 551329 551331 551339 551341 551349 551411 551412 551419 551421 551422 551423 551429 551430 551441 551442 551443 551449 551511 551512 551513 551519 551521 551522 551529 551591 551599 551611 551612 551613 551614 551621 551622 551623 551624 551631 551632 551633 551634 551641 551642 551643 551644 551691 551692 551693 551694 560121 560122 560129 560130 560210 560221 560229 560290 560311 560312 560313 560314 560391 560392 560393 560394 560410 560490 560500 560600 560721 560729 560741 560749 560750 560790 560811 560819 560890 560900 580110 580121 580122 580123 580126 580127 580131 580132 580133 580136 580137 580190 580211 580219 580220 580230 580300 580410 580421 580429 580430 580610 580620 580631 580632 580639 580640 580710 580790 580810 580890 580900 581010 581091 581092 581099 581100 590110 590190 590210 590220 590290 590310 590320 590390 590500 590610 590691 590699 590700 590800 600110 600121 600122 600129 600191 600192 600199 600240 600290 600310 600320 600330 600340 600390 600410 600490 600521 600522 600523 600524 600535 600536 600537 600538 600539 600541 600542 600543 600544 600590 600610 600621 600622 600623 600624 600631 600632 600633 600634 600641 600642 600643 600644 600690 630510 630520 630532 630533 630539 630590 630612 630619 650100 650200 650700 660320 660390 670100 670210 670290 670300 680100 680210 680221 680223 680229 680291 680292 680293 680299 680300 680410 680421 680422 680423 680510 680520 680530 680610 680620 680690 680710 680790 680800 680911 680919 680990 681011 681019 681091 681099 681140 681181 681182 681189 681280 681291 681292 681293 681299 681320 681381 681389 681410 681490 681510 681520 681591 681599 690100 690210 690220 690290 690310 690320 690390 690410 690490 690510 690590 690600 690721 690722 690723 690730 690740 690911 690912 690919 690990 691010 691090 691410 691490 700210 700220 700231 700232 700239 700312 700319 700320 700330 700420 700490 700510 700521 700529 700530 700600 700711 700719 700721 700729 700800 700910 700991 700992 701010 701020 701090 701110 701120 701190 701400 701510 701590 701610 701690 701710 701720 701790 701810 701820 701890 701911 701912 701919 701931 701932 701939 701940 701951 701952 701959 701990 702000 710122 710229 710239 710391 710399 710410 710420 710490 710610 710691 710692 710700 710811 710812 710813 710900 711011 711019 711021 711029 711031 711039 711041 711049 711100 720110 720120 720150 720211 720219 720221 720229 720230 720241 720249 720250 720260 720270 720280 720291 720292 720293 720299 720310 720390 720510 720521 720529 720610 720690 720711 720712 720719 720720 720810 720825 720826 720827 720836 720837 720838 720839 720840 720851 720852 720853 720854 720890 720915 720916 720917 720918 720925 720926 720927 720928 720990 721011 721012 721020 721030 721041 721049 721050 721061 721069 721070 721090 721113 721114 721119 721123 721129 721190 721210 721220 721230 721240 721250 721260 721310 721320 721391 721399 721410 721420 721430 721491 721499 721510 721550 721590 721610 721621 721622 721631 721632 721633 721640 721650 721661 721669 721691 721699 721710 721720 721730 721790 721810 721891 721899 721911 721912 721913 721914 721921 721922 721923 721924 721931 721932 721933 721934 721935 721990 722011 722012 722020 722090 722100 722211 722219 722220 722230 722240 722300 722410 722490 722511 722519 722530 722540 722550 722591 722592 722599 722611 722619 722620 722691 722692 722699 722710 722720 722790 722810 722820 722830 722840 722850 722860 722870 722880 722920 722990 730110 730120 730210 730230 730240 730290 730300 730411 730419 730422 730423 730424 730429 730431 730439 730441 730449 730451 730459 730490 730511 730512 730519 730520 730531 730539 730590 730611 730619 730621 730629 730630 730640 730650 730661 730669 730690 730711 730719 730721 730722 730723 730729 730791 730792 730793 730799 730810 730820 730830 730840 730890 731210 731290 731300 731412 731414 731419 731420 731431 731439 731441 731442 731449 731450 731511 731512 731519 731520 731581 731582 731589 731590 731700 731811 731812 731813 731814 731815 731816 731819 731821 731822 731823 731824 731829 732010 732020 732090 732190 732410 732421 732429 732490 732510 732591 732599 732611 732619 732620 732690 740100 740200 740311 740312 740313 740319 740321 740322 740329 740500 740610 740620 740710 740721 740729 740811 740819 740821 740822 740829 740911 740919 740921 740929 740931 740939 740940 740990 741011 741012 741021 741022 741110 741121 741122 741129 741210 741220 741300 741510 741521 741529 741533 741539 741820 741910 741991 741999 750110 750120 750210 750220 750400 750511 750512 750521 750522 750610 750620 750711 750712 750720 750810 750890 760110 760120 760310 760320 760410 760421 760429 760511 760519 760521 760529 760611 760612 760691 760692 760711 760719 760720 760810 760820 760900 761010 761090 761410 761490 761520 761610 761691 761699 780110 780191 780199 780411 780419 780420 780600 790111 790112 790120 790310 790390 790400 790500 790700 800110 800120 800300 800700 810110 810194 810196 810199 810210 810294 810295 810296 810299 810320 810390 810411 810419 810430 810490 810520 810590 810600 810720 810790 810820 810890 810920 810990 811010 811090 811100 811212 811219 811221 811229 811251 811259 811292 811299 811300 830110 830120 830130 830140 830150 830160 830170 830210 830220 830241 830242 830249 830250 830260 830510 830520 830590 830610 830710 830790 830810 830820 830890 830910 830990 831000 831110 831120 831130 831190 850690 850790 850870 850990 851090 851290 851310 851390 851610 851680 851690 853670 853990 854231 854232 854233 854239 854411 854419 854420 854442 854449 854460 854470 854710 854720 854790 900110 900120 900140 900150 900190 900211 900219 900220 900290 900311 900319 900390 900691 900699 901831 901832 901839 910811 910812 910819 910820 910890 910910 910990 911011 911012 911019 911090 911110 911120 911180 911190 911220 911290 911410 911430 911440 911490 920930 920991 920992 920994 920999 930520 930621 930629 940190 940382 940383 940389 940510 940540 940550 940560 940591 940592 940599 940610 940690 950300 960310 960340 960350 960390 960400 960610 960621 960622 960629 960630 960711 960719 960720 960860 960891 960899 961100 961210 961220 961390 962000 290341 290342 290344 290345 290346 290347 290349 290351 290359 290361 290369 290490 291230 291421 291470 291635 150200 292213 293050 293100 293221 293229 293500 293731 293740 293739 293991 293999 440610 440690 440710 441232 390760 390930 441871 441872 441890 442190 480820 480830 481410 550200 580125 580135 581010 600531 600532 600533 600534 681183 690710 690810 690890 300120 300340 310310 370251 370293 370294 370295 370590 370510 381230 382490 281210 284800 285300 690790 910911 910919 911420 940381 950410 284443 291534 293149 293159 293249 300210 300241 300242 300249 300259 320418 340231 340239 340241 340242 340249 382213 382219 382290 382489 382711 382731 382732 382751 382759 382760 382761 382762 382763 382764 382765 382768 390729 391010 401512 440713 441249 441251 441252 441291 441292 441821 580210 680611 681511 681512 681519 690190 690811 690899 701913 701914 701915 701961 701962 701963 940541 940542 940549 940561 940569 940600 940620 701964 701965 701966 701969 701971 701972 701973 741920 760619 762429 810690 810921 810929 810999 811239 811269 838440 852411 852412 852419 852491 852492 852499 940191 940199 940399 940511 940519 810610"


foreach tariff of local tariffs {
    replace bec = 22 if substr(tariff, 1, 6) == "`tariff'"
}


local tariffs"270111 270112 270119 270210 270300 270900 271121 271129 440111 440112 440110" 

foreach tariff of local tariffs {
    replace bec = 31 if substr(tariff, 1, 6) == "`tariff'"
}

local tariffs"271012 271019 271020 271011"

foreach tariff of local tariffs {
    replace bec = 32 if substr(tariff, 1, 6) == "`tariff'"
}


local tariffs"270120 270220 270400 270500 271111 271112 271113 271114 271119 271600 340311 340319 340391 340399 440210 440290"


foreach tariff of local tariffs {
    replace bec = 322 if substr(tariff, 1, 6) == "`tariff'"
}


local tariffs"010121 010130 010210 010221 010231 010290 010310 711510 711590 730900 731010 731021 731029 731100 732211 732219 732290 761100 761210 761290 761300 820110 820130 820140 820150 820160 820190 820210 820310 820320 820330 820340 820411 820412 820420 820510 820520 820530 820540 820559 820560 820570 820590 820600 830300 830400 840110 840120 840130 840211 840212 840219 840220 840310 840410 840420 840510 840610 840681 840682 840790 840890 841011 841012 841013 841221 841229 841231 841239 841280 841311 841319 841320 841330 841340 841350 841360 841370 841381 841382 841410 841420 841430 841440 841459 841480 841581 841582 841583 841610 841620 841630 841710 841720 841780 841850 841861 841869 841911 841919 841920 841931 841932 841939 841940 841950 841960 841981 841989 842010 842111 842112 842119 842121 842122 842123 842129 842131 842139 842219 842220 842230 842240 842320 842330 842381 842382 842389 842410 842420 842430 842441 842449 842482 842489 842511 842519 842531 842539 842541 842542 842549 842611 842612 842619 842620 842630 842641 842649 842691 842699 842710 842720 842790 842810 842820 842831 842832 842833 842839 842840 842860 842890 842911 842919 842920 842930 842940 842951 842952 842959 843010 843020 843031 843039 843041 843049 843050 843061 843069 843210 843221 843229 843231 843239 843241 843242 843280 843320 843330 843340 843351 843352 843353 843359 843360 843410 843420 843510 843610 843621 843629 843680 843710 843780 843810 843820 843830 843840 843850 843860 843880 843910 843920 843930 844010 844110 844120 844130 844140 844180 844230 844311 844312 844313 844314 844315 844316 844317 844319 844331 844332 844339 844391 844399 844400 844511 844512 844513 844519 844520 844530 844540 844590 844610 844621 844629 844630 844711 844712 844720 844790 844900 845020 845110 845129 845130 845140 845150 845180 845221 845229 845310 845320 845380 845410 845420 845430 845510 845521 845522 845611 845612 845620 845630 845640 845650 845690 845710 845720 845730 845811 845819 845891 845899 845910 845921 845929 845931 845939 845941 845949 845951 845959 845961 845969 845970 846012 846019 846022 846023 846024 846029 846031 846039 846040 846090 846120 846130 846140 846150 846190 846210 846221 846229 846231 846239 846241 846249 846291 846299 846310 846320 846330 846390 846410 846420 846490 846510 846520 846591 846592 846593 846594 846595 846596 846599 846711 846719 846721 846722 846729 846781 846789 846810 846820 846880 847021 847029 847030 847050 847090 847130 847141 847149 847150 847160 847170 847180 847190 847210 847230 847290 847410 847420 847431 847432 847439 847480 847510 847521 847529 847621 847629 847681 847689 847710 847720 847730 847740 847751 847759 847780 847810 847910 847920 847930 847940 847950 847960 847971 847979 847981 847982 847989 848010 848020 848030 848041 848049 848050 848060 848071 848079 848610 848620 848630 848640 850110 850120 850131 850132 850133 850134 850140 850151 850152 850153 850161 850162 850163 850164 850211 850212 850213 850220 850231 850239 850240 850410 850421 850422 850423 850431 850432 850433 850434 850440 850450 850511 850519 850520 850590 850819 850860 851410 851420 851430 851440 851511 851519 851521 851529 851531 851539 851580 851633 851712 851718 851761 851762 851769 851810 851821 851822 851829 851830 851840 851850 851920 851981 851989 852110 852190 852352 852359 852550 852560 852580 852610 852691 852692 852791 852792 852799 852842 852849 852852 852859 852862 852871 852873 853010 853080 853110 853120 853180 853210 853221 853222 853223 853224 853225 853229 853230 853950 854231 854232 854233 854239 854310 854320 854330 854370 860800 870110 870130 870191 870192 870193 870194 870195 870911 870919 890510 890520 890590 890790 900580 900630 900640 900652 900653 900659 900710 900720 900850 901010 901050 901060 901110 901120 901180 901210 901310 901320 901380 901410 901420 901480 901510 901520 901530 901540 901580 901600 901710 901720 901730 901780 901811 901812 901813 901814 901819 901820 901841 901849 901850 901890 901910 901920 902000 902212 902213 902214 902219 902221 902229 902300 902410 902480 902511 902519 902580 902610 902620 902680 902710 902720 902730 902750 902780 902790 902810 902820 902830 902910 902920 903010 903020 903031 903032 903033 903039 903040 903082 903084 903089 903110 903120 903141 903149 903180 903210 903220 903281 903289 910610 910690 910700 930390 940130 940180 940210 940290 940310 940320 940330 950430 950450 950490 950810 950890 961800 820120 820580 842481 843230 803240 845610 845940 846011 846921 846900 852851 852861 870190 900610 900719 900820 900830 900840 902781 902789 903310 903390 940139 950823 950824 950826 950829 950830 848520 848580 850171 850172 851419 851431 851432 851439 851662 851713 851714 852531 852581 852583 852589 852852 845240 846021 846211 846219 846222 846223 846224 846225 846226 846232 846233 843233 846242 846251 846259 846261 846262 846263 846269 846290 870121 841470 841481 841912 841931 841934 841935 841933 842132 842870 853952 874160"

foreach tariff of local tariffs {
    replace bec = 41 if substr(tariff, 1, 6) == "`tariff'"
}

local tariffs"401011 401012 401019 401031 401032 401033 401034 401035 401036 401039 420500 590900 591000 591110 591120 591131 591132 591140 591190 820220 820231 820239 820240 820291 820299 820713 820719 820720 820730 820740 820750 820760 820770 820780 820790 820810 820820 820830 820840 820890 820900 821194 821195 840140 840290 840390 840490 840590 840690 841090 841290 841391 841392 841490 841590 841690 841790 841891 841899 841990 842091 842099 842191 842199 842290 842390 842490 843110 843120 843131 843139 843141 843142 843143 843149 843290 843390 843490 843590 843691 843699 843790 843890 843991 843999 844090 844190 844240 844250 844391 844399 844811 844819 844820 844831 844832 844833 844839 844842 844849 844851 844859 845090 845190 845230 845290 845390 845490 845530 845590 846610 846620 846630 846691 846692 846693 846694 846791 846792 846799 846890 847321 847329 847330 847340 847350 847490 847590 847690 847790 847890 847990 848110 848120 848130 848140 848180 848190 848210 848220 848230 848240 848250 848280 848291 848299 848310 848320 848330 848340 848350 848360 848390 848410 848420 848490 848690 848710 848790 850300 850490 850870 851490 851590 851770 851890 852210 852290 852321 852329 852341 852349 852351 852352 852359 852380 852910 852990 853090 853190 853290 853310 853321 853329 853331 853339 853340 853390 853400 853510 853521 853529 853530 853540 853590 853610 853620 853630 853641 853649 853650 853661 853669 853690 853710 853720 853810 853890 853929 853931 853932 853939 853941 853949 854011 854012 854020 854040 854060 854071 854079 854081 854089 854091 854099 854110 854121 854129 854130 854140 854150 854160 854190 854231 854232 854233 854239 854290 854390 854511 854519 854520 854590 854610 854620 854690 854890 870990 900590 900661 900669 900791 900792 900890 901090 901190 901290 901390 901490 901590 901790 902230 902290 902490 902590 902690 902890 902990 903090 903190 903290 903300 930630 962000 843240 847310 852340 854072 591010 988427 988429 822859 844081 844231 848590 851771 851779 853951 854141 854142 854143 854149 854151 854159 854800 854859"

foreach tariff of local tariffs {
    replace bec = 42 if substr(tariff, 1, 6) == "`tariff'"
}


local tariffs"870321 870322 870323 870324 870331 870332 870333 870340 870350 870360 870370 870380 870390"


foreach tariff of local tariffs {
    replace bec = 51 if substr(tariff, 1, 6) == "`tariff'"
}


local tariffs"860110 860120 860210 860290 860310 860390 860400 860500 860610 860630 860691 860692 860699 860900 870120 870210 870220 870230 870240 870290 870410 870421 870422 870423 870431 870432 870490 870510 870520 870530 870540 870590 871620 871631 871639 871640 871680 880100 880211 880212 880230 880240 880260 890110 890120 890130 890190 890200 890400 870441 870460"

foreach tariff of local tariffs {
    replace bec = 521 if substr(tariff, 1, 6) == "`tariff'"
}

local tariffs"840721 870310 871110 871120 871130 871140 871150 871160 871190 871200 871310 871390 871610 880100 880220 890310 890391 890392 890399 890710 890333 988711 988712"

foreach tariff of local tariffs {
    replace bec = 522 if substr(tariff, 1, 6) == "`tariff'"
}

local tariffs"401110 401120 401130 401140 401150 401170 401180 401190 401211 401212 401213 401219 401220 401290 401310 401320 401390 731600 830230 840710 840729 840731 840732 840733 840734 840810 840820 840910 840991 840999 841111 841112 841121 841122 841181 841182 841191 841199 841210 841520 850710 850720 850730 850740 850750 850760 850780 851110 851120 851130 851140 851150 851180 851190 851210 851220 851230 851240 852721 852729 853910 854430 860711 860712 860719 860721 860729 860730 860791 860799 870600 870710 870790 870810 870821 870829 870830 870840 870850 870870 870880 870891 870892 870893 870894 870895 870899 871410 871420 871491 871492 871493 871494 871495 871496 871499 871690 880310 880320 880330 880390 910400 940110 940120 871411 871419 870822 870839 870860 988704 988703 988702 988701 988433 401161 401162 401163 401169 401192 401193 401194 401199"


foreach tariff of local tariffs {
    replace bec = 53 if substr(tariff, 1, 6) == "`tariff'"
}

local tariffs"481110 481151 481159 481160 481190 482390 570110 570190 570210 570220 570231 570232 570239 570241 570242 570249 570250 570291 570292 570299 570310 570320 570330 570390 570410 570420 570490 570500 590410 590490 711311 711319 711320 711411 711419 711420 711610 711620 732111 732112 732119 732181 732182 732189 741810 741999 821000 841451 841460 841510 841810 841821 841829 841830 841840 842211 843311 843319 845011 845012 845019 845121 845210 850811 850819 850860 850940 850980 851010 851020 851030 851621 851629 851631 851632 851640 851650 851660 851671 851672 851679 851920 851930 851981 851989 852580 852712 852713 852719 852862 852869 852871 852872 854231 854232 854239 871500 900510 900651 900652 900653 900659 900710 900850 902121 902129 902131 902139 902140 902150 902190 910111 910119 910121 910129 910191 910199 910211 910212 910219 910221 910229 910291 910299 910310 910390 910511 910519 910521 910529 910591 910599 920110 920120 920190 920210 920290 920510 920590 920600 920710 920790 920810 920890 920999 930310 930320 930330 930400 940140 940161 940169 940171 940179 940340 940350 940360 940370 940390 962000 970200 970300 970400 970500 970600 900810 900711 852841 940149"


foreach tariff of local tariffs {
    replace bec = 61 if substr(tariff, 1, 6) == "`tariff'"
}

local tariffs"300691 392220 392410 392490 392530 392640 392690 420100 420211 420212 420219 420221 420222 420229 420231 420232 420239 420291 420292 420299 420310 420321 420329 420330 420340 420500 430310 430390 430400 441400 441911 441912 441919 441990 442010 442090 442110 460121 460122 460129 460192 460193 460194 460199 460211 460212 460219 460290 490400 490510 580500 610120 610130 610190 610210 610220 610230 610290 610310 610322 610323 610329 610331 610332 610333 610339 610341 610342 610343 610349 610413 610419 610422 610423 610429 610431 610432 610433 610439 610441 610442 610443 610444 610449 610451 610452 610453 610459 610461 610462 610463 610469 610510 610520 610590 610610 610620 610690 611011 611012 611019 611020 611030 611090 611120 611130 611190 611211 611212 611219 611220 611231 611239 611241 611249 611300 611420 611430 611490 611710 611780 620111 620112 620113 620119 620191 620192 620193 620199 620211 620212 620213 620219 620291 620292 620293 620299 620311 620312 620319 620322 620323 620329 620331 620332 620333 620339 620341 620342 620343 620349 620411 620412 620413 620419 620421 620422 620423 620429 620431 620432 620433 620439 620441 620442 620443 620444 620449 620451 620452 620453 620459 620461 620462 620463 620469 620520 620530 620590 620610 620620 620630 620640 620690 620920 620930 620990 621010 621020 621030 621040 621050 621111 621112 621120 621132 621133 621139 621142 621143 621149 630110 630120 630130 630140 630190 630210 630221 630222 630229 630231 630232 630239 630240 630251 630253 630259 630260 630291 630293 630299 630312 630319 630391 630392 630399 630411 630419 630420 630491 630492 630493 630499 630622 630629 630630 630640 630690 630710 630720 630790 630800 640110 640192 640199 640212 640219 640220 640291 640299 640312 640319 640320 640340 640351 640359 640391 640399 640411 640419 640420 640510 640520 640590 640610 640620 640690 650400 650500 650610 650691 650699 660110 660191 660199 660200 670411 670419 670420 670490 691110 691190 691200 691310 691390 701310 701322 701328 701333 701337 701341 701342 701349 701391 701399 711711 711719 711790 732310 732391 732392 732393 732394 732399 741810 761510 820551 821110 821191 821192 821193 821300 821410 821420 821490 821510 821520 821591 821599 830621 830629 830630 842310 847010 851711 851950 852321 852329 852341 852349 852351 852359 852380 853670 854231 854232 854233 854239 900410 900490 902110 911310 911320 911390 940152 940153 940159 940410 940421 940429 940430 940490 940520 950300 950420 950450 950611 950612 950619 950621 950629 950631 950639 950640 950651 950659 950662 950669 950670 950691 950699 950710 950730 950790 960110 960190 960200 960500 961000 961320 961380 961400 961511 961519 961590 961610 961700 961900 962000 970110 630699 640691 640699 650510 650590 741811 741819 761511 761519 940151 950410 420339 441900 620140 630359 701339 730250 902010 940321 940329 940391 940521 970191"


foreach tariff of local tariffs {
    replace bec = 62 if substr(tariff, 1, 6) == "`tariff'"
}

local tariffs"030110 030111 030119 060311 060312 060313 060314 060315 060319 060390 230910 240210 240220 240290 240311 240319 240391 300410 300420 300431 300432 300439 300441 300442 300443 300449 300450 300460 300490 300660 321310 321390 330300 330410 330420 330430 330491 330499 330510 330520 330530 330590 330610 330620 330690 330710 330720 330730 330741 330749 330790 340111 340119 340120 340130 340220 340510 340520 340530 340540 340590 340600 350610 360500 360610 370252 370253 370254 370296 370297 380852 380859 380861 380862 380869 380891 380892 380893 380894 380899 392620 401410 401519 401590 401610 401691 401692 401695 481310 481710 481720 481730 481810 481820 481830 481850 481890 482020 482050 482361 482369 490110 490191 490199 490210 490290 490300 490591 490599 490890 490900 491000 491191 500600 510910 510990 520420 520710 520790 540600 551110 551120 551130 610711 610712 610719 610721 610722 610729 610791 610799 610811 610819 610821 610822 610829 610831 610832 610839 610891 610892 610899 610910 610990 611510 611521 611522 611529 611530 611594 611595 611596 611599 611610 611691 611692 611693 611699 611780 611790 620711 620719 620721 620722 620729 620791 620799 620811 620819 620821 620822 620829 620891 620892 620899 621210 621220 621230 621290 621320 621390 621410 621420 621430 621440 621490 621510 621520 621590 621600 621710 621790 680430 731940 731990 821210 821220 821290 850610 850630 850640 850650 850660 850680 853921 853922 854231 854232 854239 900130 940530 950300 950440 950510 950590 950632 950661 950720 960321 960329 960330 960810 960820 960830 960840 960850 960910 960920 960990 961310 961620 961900 970190 240310 300440 380850 960839 960831 731920 731930 240320 340250 481840 560110 940531 940539 960320"

foreach tariff of local tariffs {
    replace bec = 63 if substr(tariff, 1, 6) == "`tariff'"
}

local tariffs"711810 854231 854232 854239 871000 880400 880510 880521 880529 890610 890690 930110 930120 930190 930200 930510 930591 930599 930630 930690 930700 999999"

foreach tariff of local tariffs {
    replace bec = 7 if substr(tariff, 1, 6) == "`tariff'"
}

/// BEC goods by HS to BEC convertion table

gen intermadiate = 0
replace intermadiate = 1 if (bec == 111 | bec == 121 | bec == 21 | bec == 22 | bec == 31 | bec == 322 | bec == 42 | bec == 53)	


gen consumption = 0
 
replace consumption = 1 if (bec == 61 | bec == 62 | bec == 63 | bec  == 522 | bec == 112 | bec == 122)

gen capital = 0

replace capital = 1 if (bec == 521 | bec == 41)

gen not_classified = 0

replace not_classified = 1 if (bec == 7 | bec == 51 | bec ==321) 

 save "im_reg.dta", replace

/////////////////////////////////

gen group_bec = ""
replace group_bec = "intermadiate"  if (bec == 111 | bec == 121 | bec == 21 | bec == 22 | bec == 31 | bec == 322 | bec == 42 | bec == 53)	

replace group_bec = "consumption" if (bec == 61 | bec == 62 | bec == 63 | bec  == 522 | bec == 112 | bec == 122)
replace group_bec = "capital" if (bec == 521 | bec == 41)
replace group_bec = "not_classified" if (bec == 7 | bec == 51 | bec ==321) 
gen group_s = substr(tariff, 1, 3)

gen gap_inter =gap*intermadiate
gen gap_con = gap*consumption
gen gap_capital = gap*capital
gen gap_not = gap*not_classified

// reg BEC based on consumption goods

reg realvalue_im intermadiate capital not_classified gap gap_capital gap_inter gap_not i.month_yr
outreg2 using "reg_im_BEC.doc", replace

reghdfe realvalue_im gap gap_capital gap_inter gap_not i.month_yr, absorb(tariff)
outreg2 using "reg_im_BEC.doc", append
//////////////lag of gap

sort tariff month_year

gen gap_l = gap[_n-1] if tariff == tariff[_n-1]
replace gap_l = 0 if gap_l == .
gen gap_l_sec = gap[_n-2] if tariff == tariff[_n-2]
replace gap_l_sec = 0 if gap_l_sec == .
gen gap_l_thir = gap[_n-3] if tariff == tariff[_n-3]
replace gap_l_thir = 0 if gap_l_thir == .

gen preferential = 0
replace preferential = 1 if group == 1 & month_yr>= 139702
gen nima = 0
replace nima = 1 if  (group == 2 | group == 21 | group == 22 | group == 23 ) & month_yr >= 139702 & month_yr < 139907
replace nima = 1 if (group == 21 | group == 2) & month_yr >= 139907
gen nima_t_n = 0
replace nima_t_n = 1 if (group == 22 | group == 23 | group == 24 | group == 25 | group == 26) &  month_yr >= 139907

gen gap_s = preferential*gap

gen gap_nima_t = nima_t_n*gap

gen gap_nima = nima*gap

reg realvalue_im preferential nima nima_t_n gap gap_s gap_nima gap_nima_t i.month_yr
outreg2 using "reg_nima_preferential_gap_nima_preferential.doc", replace
reghdfe realvalue_im preferential nima nima_t_n gap gap_s gap_nima gap_nima_t  i.month_yr, absorb(tariff)
outreg2 using "reg_nima_preferential_gap_nima_preferential.doc", append


sort tariff month_year
gen nima_l = nima[_n-1] if tariff == tariff[_n-1]
replace nima_l = 0 if nima_l ==.
gen preferential_l = preferential[_n-1] if tariff == tariff[_n-1]
replace preferential_l = 0 if preferential_l == .
gen nima_t_l = nima_t_n[_n-1] if tariff == tariff[_n-1]
replace nima_t_l = 0 if nima_t_l ==.
gen gap_l_nima_t = nima_t_l*gap_l
gen gap_l_s = preferential_l*gap_l
gen gap_l_nima = nima_l*gap_l


///

reg realvalue_im preferential_l nima_l nima_t_l gap_l gap_l_s gap_l_nima gap_l_nima_t i.month_yr
outreg2 using "reg_nima_preferential_gap_nima_preferential_lag.doc", replace
reghdfe realvalue_im preferential_l nima_l nima_t_l gap_l gap_l_s gap_l_nima gap_l_nima_t i.month_yr, absorb(tariff)
outreg2 using "reg_nima_preferential_gap_nima_preferential_lag.doc", append
